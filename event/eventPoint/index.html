<style>
.resize-container{
    position: absolute;
    display: inline-block;
    cursor: move;
    margin: 0 auto;
    border: 1px solid red;
}
.resize-container img{
    display: block
}
.resize-container:hover img,
.resize-container:active img{
    outline: 2px dashed rgba(222, 60, 80, 0.9);
}
.resize-handle-ne,
.resize-handle-ne,
.resize-handle-se,
.resize-handle-nw,
.resize-handle-sw{
    position: absolute;
    display: block;
    width: 10px;
    height: 10px;
    background: rgba(222, 60, 80, 0.9);
    z-index: 999;
}
.resize-handle-nw{
    top: -5px;
    left: -5px;
    cursor: nw-resize;
}
.resize-handle-sw{
    bottom: -5px;
    left: -5px;
    cursor: sw-resize;
}
.resize-handle-ne{
    top: -5px;
    right: -5px;
    cursor: ne-resize;
}
.resize-handle-se{
    bottom: -5px;
    right: -5px;
    cursor: se-resize;
}
</style>
<body>
    <div class="resize-container" id="resize-container">
    <span class="resize-handle resize-handle-nw"></span>
    <span class="resize-handle resize-handle-ne"></span> 
    <span class="resize-handle resize-handle-se"></span>
    <span class="resize-handle resize-handle-sw"></span>
    </div>
    <canvas></canvas>
    <button id="cropImg">Crop</button>
</body>
<script>
//выделяем блоки
let resizeContainer = document.getElementById("resize-container");
let resizeHandle = document.getElementsByClassName("resize-handle");
//Создаем блок для сбора информации по перемешению
let eventState = {};
let constrain = false;
let min_width = 60,
    min_height = 60,
    max_width = 800,
    max_height = 900;
//Прослушка контейнера 
for (let i = 0; i < resizeHandle.length; i++) {
    resizeHandle[i].addEventListener("mousedown", startResize);   
}
/*Меняем размер блока*/
//Говорим что делать при нажатии на точки
//Начало
function startResize(e) {
    e.preventDefault();
    e.stopPropagation();
    //передаем в функцию для сохранения
    saveEventState(e);
    //Прослушиватели документа
    document.addEventListener("mousemove", resizing);
    document.addEventListener("mouseup", endResize);
}
//Конец
function endResize(e) {
    e.preventDefault();
    //Прослушиватели документа
    document.removeEventListener("mouseup", endResize);
    document.removeEventListener("mousemove", resizing);
}
//Обрабатываем события
//запись значения размеров контейнера и другую важную информацию
function saveEventState(e) {
    eventState.conteinerWidth = resizeContainer.clientWidth;
    eventState.conteinerHeight = resizeContainer.clientHeight;
    eventState.conteinerLeft = resizeContainer.offsetLeft;
    eventState.conteinerTop = resizeContainer.offsetTop;
    eventState.mouseX = (e.clientX || e.pageX || e.originalEvent.touches[0].clientX);
    eventState.mouseY = (e.clientY || e.pageY || e.originalEvent.touches[0].clientY);
    eventState.evnt = e;
}
//основные действия
function resizing(e) {
    let mouse={},
    width,
    height,
    left,
    top;
    mouse.x = (e.clientX || e.pageX || e.originalEvent.touches[0].clientX);
    mouse.y = (e.clientY || e.pageY || e.originalEvent.touches[0].clientY);
    
    // Изменим положение фотографии в зависимости от того, за какую размерную ручку тянет юзер
    if( eventState.evnt.target.classList == 'resize-handle resize-handle-se'){
        width = mouse.x - eventState.conteinerLeft;
        height = mouse.y - eventState.conteinerTop;
        left = eventState.conteinerLeft;
        top = eventState.conteinerTop;
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-sw'){
        width = eventState.conteinerWidth - (mouse.x - eventState.conteinerLeft);
        height = mouse.y - eventState.conteinerTop;
        left = mouse.x;
        top = eventState.conteinerTop;
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-nw'){
        width = eventState.conteinerWidth - (mouse.x - eventState.conteinerLeft);
        height = eventState.conteinerHeight - (mouse.y - eventState.conteinerTop);
        left = mouse.x;
        top = mouse.y;
        
        if(constrain || e.shiftKey){
            top = mouse.y - ((width / resizeContainer.clientWidth * resizeContainer.clientHeight) - height);
        }
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-ne'){
        width = mouse.x - eventState.conteinerLeft;
        height = eventState.conteinerHeight - (mouse.y - eventState.conteinerTop);
        left = eventState.conteinerLeft;
        top = mouse.y;
        
        if(constrain || e.shiftKey){
           top = mouse.y - ((width / resizeContainer.clientWidth * resizeContainer.clientHeight) - height);
        }
    }

    // Сохраняем пропорции при нажатой клавише shift
    if(constrain || e.shiftKey){
        height = width / resizeContainer.clientWidth * resizeContainer.clientHeight;
    }

    if(width > min_width && height > min_height && width < max_width && height < max_height){
        
        // Чтобы улучшить производительность, стоит ограничить количество использований resizeImage()
        resizeImage(width, height);

    } 
    
}
//Меняем размеры блока JavaScript
function resizeImage(width, height){
    resizeContainer.style.width = width;
    resizeContainer.style.height = height;
};
/*Перемешаем блок*/
//Добовляем прослушку на перемкшение
resizeContainer.addEventListener('mousedown',startMoving);
//Начало
function startMoving(e){
    e.preventDefault();
    e.stopPropagation();
    saveEventState(e);
    document.addEventListener('mousemove', moving);
    document.addEventListener('mouseup', endMoving);
};
//Конец
function endMoving(e){
    e.preventDefault();
    document.removeEventListener('mouseup', endMoving);
    document.removeEventListener('mousemove', moving);
};
//Перемешаем
function moving(e) {
    let mouse={};
    e.preventDefault();
    e.stopPropagation();
    mouse.x = (e.clientX || e.pageX);
    mouse.y = (e.clientY || e.pageY);
    resizeContainer.style.left = mouse.x - ( eventState.mouseX - eventState.conteinerLeft);
    resizeContainer.style.top = mouse.y - ( eventState.mouseY - eventState.conteinerTop);
    //Перемешаем
    resizeContainer.style.left = mouse.x - ( eventState.mouseX - eventState.conteinerLeft);
    resizeContainer.style.top = mouse.y - ( eventState.mouseY - eventState.conteinerTop);
}
/*Реализация функционала - вырезаем часть фото*/
//Crop imagen
let imgCrop = document.getElementById("imgCrop");
let canvas = document.querySelector("canvas");
let ctx = canvas.getContext('2d');
let img = new Image();
    img.src = "./kiza.jpeg";
let cropImg = document.getElementById("cropImg");
img.addEventListener("load", init);
function init(){
    resizeContainer.style.width = img.width;
    resizeContainer.style.height = img.height;
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0,0);
    cropImg.addEventListener("click", cropNewFoto);
}
function cropNewFoto() {
    let left = resizeContainer.offsetLeft,
        top = resizeContainer.offsetTop,
        width = resizeContainer.clientWidth,
        height = resizeContainer.clientHeight,
        cropCanvas = document.createElement("canvas");
        cropCanvas.width = width;
        cropCanvas.height = height;
        cropCanvas.getContext('2d').drawImage(img, left, top, width, height, 0, 0, width, height);
        console.log(left, top, width, height, 0, 0, width, height);


    //определяем браузер
    if (navigator.userAgent.indexOf("Chrome") != -1) {
        let string = cropCanvas.toDataURL("image/png"),
        iframe = "<iframe width='"+width+"px' height='"+height+"px' src='" + string + "'></iframe>",
        x = window.open();
        x.document.open();
        x.document.write(iframe);
        x.document.close();
    } else {
    //не работает в Chrome
       window.open(crop_canvas.toDataURL("image/png")); 
    }
}
</script>