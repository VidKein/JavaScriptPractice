<style>
body{
    padding: 0;
    margin: 0;
    border: 0;
}
.resize-container{
    position: absolute;
    display: inline-block;
    cursor: move;
    margin: 0 auto;
    border: 1px solid red;
}
.resize-container img{
    display: block
}
.resize-container:hover img,
.resize-container:active img{
    outline: 2px dashed rgba(222, 60, 80, 0.9);
}
.resize-handle-ne,
.resize-handle-ne,
.resize-handle-se,
.resize-handle-nw,
.resize-handle-sw{
    position: absolute;
    display: block;
    width: 10px;
    height: 10px;
    background: rgba(222, 60, 80, 0.9);
    z-index: 999;
}
.resize-handle-nw{
    top: -5px;
    left: -5px;
    cursor: nw-resize;
}
.resize-handle-sw{
    bottom: -5px;
    left: -5px;
    cursor: sw-resize;
}
.resize-handle-ne{
    top: -5px;
    right: -5px;
    cursor: ne-resize;
}
.resize-handle-se{
    bottom: -5px;
    right: -5px;
    cursor: se-resize;
}
input[type="text"]{width: 70px;}
</style>
<body>
    <div class="resize-container" id="resize-container">
    <span class="resize-handle resize-handle-nw"></span>
    <span class="resize-handle resize-handle-ne"></span> 
    <span class="resize-handle resize-handle-se"></span>
    <span class="resize-handle resize-handle-sw"></span>
    </div>
    <canvas></canvas>
    <p><button id="cropImgNew">Crop New imagen</button>
    <button id="cropImg">Crop imagen</button></p>
    <div class="infoTop">
        <span>Top:</span>
        <input type="text" id="dataTop">
        <span>px</span>
    </div>
    <div class="infoLeft">
        <span>Left:</span>
        <input type="text" id="dataLeft">
        <span>px</span>
    </div>
    <div class="infoWidth">
        <span>Width:</span>
        <input type="text" id="dataWidth">
        <span>px</span>
    </div>
    <div class="infoHeight">
        <span>Height:</span>
        <input type="text" id="dataHeight">
        <span>px</span>
    </div>
    <div class="buttonActionImg">
        <p><button id="reset">Reset</button></p>
    </div>
</body>
<script>
//выделяем блоки
let resizeContainer = document.getElementById("resize-container");
let resizeHandle = document.getElementsByClassName("resize-handle");
//Создаем блок для сбора информации по перемешению
let eventState = {};
let constrain = false;
let min_width = 60,
    min_height = 60,
    max_width = 800,
    max_height = 900;
//Прослушка контейнера 
for (let i = 0; i < resizeHandle.length; i++) {
    resizeHandle[i].addEventListener("mousedown", startResize);   
}
/*Меняем размер блока*/
//Говорим что делать при нажатии на точки
//Начало
function startResize(e) {
    e.preventDefault();
    e.stopPropagation();
    //передаем в функцию для сохранения
    saveEventState(e);
    //Прослушиватели документа
    document.addEventListener("mousemove", resizing);
    document.addEventListener("mouseup", endResize);
}
//Конец
function endResize(e) {
    e.preventDefault();
    //Прослушиватели документа
    document.removeEventListener("mouseup", endResize);
    document.removeEventListener("mousemove", resizing);
}
//Обрабатываем события
//запись значения размеров контейнера и другую важную информацию
function saveEventState(e) {
    eventState.conteinerWidth = resizeContainer.clientWidth;
    eventState.conteinerHeight = resizeContainer.clientHeight;
    eventState.conteinerLeft = resizeContainer.offsetLeft;
    eventState.conteinerTop = resizeContainer.offsetTop;
    eventState.mouseX = (e.clientX || e.pageX || e.originalEvent.touches[0].clientX);
    eventState.mouseY = (e.clientY || e.pageY || e.originalEvent.touches[0].clientY);
    eventState.evnt = e;
    
}

//основные действия
function resizing(e) {
    let mouse={},
    width,
    height,
    left,
    top;
    mouse.x = (e.clientX || e.pageX || e.originalEvent.touches[0].clientX);
    mouse.y = (e.clientY || e.pageY || e.originalEvent.touches[0].clientY);
    
    // Изменим положение фотографии в зависимости от того, за какую размерную ручку тянет юзер
    if( eventState.evnt.target.classList == 'resize-handle resize-handle-se'){
        width = mouse.x - eventState.conteinerLeft;
        height = mouse.y - eventState.conteinerTop;
        left = eventState.conteinerLeft;
        top = eventState.conteinerTop;
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-sw'){
        width = eventState.conteinerWidth - (mouse.x - eventState.conteinerLeft);
        height = mouse.y - eventState.conteinerTop;
        left = mouse.x;
        top = eventState.conteinerTop;
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-nw'){
        width = eventState.conteinerWidth - (mouse.x - eventState.conteinerLeft);
        height = eventState.conteinerHeight - (mouse.y - eventState.conteinerTop);
        left = mouse.x;
        top = mouse.y;
        
        if(constrain || e.shiftKey){
            top = mouse.y - ((width / resizeContainer.clientWidth * resizeContainer.clientHeight) - height);
        }
    } else if(eventState.evnt.target.classList == 'resize-handle resize-handle-ne'){
        width = mouse.x - eventState.conteinerLeft;
        height = eventState.conteinerHeight - (mouse.y - eventState.conteinerTop);
        left = eventState.conteinerLeft;
        top = mouse.y;
        
        if(constrain || e.shiftKey){
           top = mouse.y - ((width / resizeContainer.clientWidth * resizeContainer.clientHeight) - height);
        }
    }

    // Сохраняем пропорции при нажатой клавише shift
    if(constrain || e.shiftKey){
        height = width / resizeContainer.clientWidth * resizeContainer.clientHeight;
    }

    if(width > min_width && height > min_height && width < max_width && height < max_height){
        
        // Чтобы улучшить производительность, стоит ограничить количество использований resizeImage()
        resizeImage(width, height);
    } 
        document.getElementById("dataWidth").value =  width;
        document.getElementById("dataHeight").value =  height;
}
//Меняем размеры блока JavaScript
function resizeImage(width, height){
    resizeContainer.style.width = width;
    resizeContainer.style.height = height;
};
/*Перемешаем блок*/
//Добовляем прослушку на перемкшение
resizeContainer.addEventListener('mousedown',startMoving);
//Начало
function startMoving(e){
    e.preventDefault();
    e.stopPropagation();
    saveEventState(e);
    document.addEventListener('mousemove', moving);
    document.addEventListener('mouseup', endMoving);
};
//Конец
function endMoving(e){
    e.preventDefault();
    document.removeEventListener('mouseup', endMoving);
    document.removeEventListener('mousemove', moving);
};
//Перемешаем
function moving(e) {
    let mouse={};
    e.preventDefault();
    e.stopPropagation();
    mouse.x = (e.clientX || e.pageX);
    mouse.y = (e.clientY || e.pageY);
    //Перемешаем
    resizeContainer.style.left = mouse.x - ( eventState.mouseX - eventState.conteinerLeft);
    resizeContainer.style.top = mouse.y - ( eventState.mouseY - eventState.conteinerTop);
    document.getElementById("dataTop").value = mouse.y - ( eventState.mouseY - eventState.conteinerTop);
    document.getElementById("dataLeft").value = mouse.x - ( eventState.mouseX - eventState.conteinerLeft);
    
}
/*Реализация функционала - вырезаем часть фото*/
//Crop imagen
let imgCrop = document.getElementById("imgCrop");
let canvas = document.querySelector("canvas");
let ctx = canvas.getContext('2d');
let img = new Image();
    img.src = "./kiza.jpeg";
let cropImgNew = document.getElementById("cropImgNew");
let cropImg = document.getElementById("cropImg");
img.addEventListener("load", init);
function init(){
    resizeContainer.style.width = img.width;
    resizeContainer.style.height = img.height;
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0,0);
    document.getElementById("dataWidth").value =  img.width;
    document.getElementById("dataHeight").value =  img.height;
    document.getElementById("dataTop").value = resizeContainer.offsetTop;
    document.getElementById("dataLeft").value = resizeContainer.offsetLeft;
}
cropImgNew.addEventListener("click", cropNewFoto);
cropImg.addEventListener("click", crop);
function cropNewFoto() {
    let left = resizeContainer.offsetLeft,
        top = resizeContainer.offsetTop,
        width = resizeContainer.clientWidth,
        height = resizeContainer.clientHeight,
        cropCanvas = document.createElement("canvas");
        let imgData = ctx.getImageData(left, top, width, height);        
        cropCanvas.width = width;
        cropCanvas.height = height;
        cropCanvas.getContext('2d').putImageData(imgData, 0,0);
    
    //определяем браузер
    if (navigator.userAgent.indexOf("Chrome") != -1) {
        let string = cropCanvas.toDataURL("image/png"),
        iframe = "<iframe width='"+width+"px' height='"+height+"px' src='" + string + "' scrolling='no'></iframe><p><span>Ширина "+width+"</span></p><p><span>Высота "+height+"</span></p>",
        x = window.open();
        x.document.open();
        x.document.write(iframe);
        x.document.close();
    } else {
    //не работает в Chrome
       window.open(cropCanvas.toDataURL("image/png")); 
    }
}
function crop() {
//Собираем информацию о картинке
let imgData = ctx.getImageData(resizeContainer.offsetLeft, resizeContainer.offsetTop, resizeContainer.clientWidth, resizeContainer.clientHeight);
//Устанавливаем новые размеры canvas(затираем)
canvas.width = resizeContainer.clientWidth;
canvas.height = resizeContainer.clientHeight;
//Вносим новіе данніе в канвас
ctx.putImageData(imgData,0,0);
//Передвигаем кроп блок
resizeContainer.style.left = canvas.offsetLeft;
resizeContainer.style.top = canvas.offsetTop;
document.getElementById("dataWidth").value =  resizeContainer.clientWidth;
document.getElementById("dataHeight").value =  resizeContainer.clientHeight;
document.getElementById("dataTop").value = resizeContainer.offsetTop;
document.getElementById("dataLeft").value = resizeContainer.offsetLeft;
}
/*Функция резет*/
let resetCrop = document.getElementById("reset");
resetCrop.addEventListener("click", reset);
function reset() {
    resizeContainer.style.width = img.width;
    resizeContainer.style.height = img.height;
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0,0);
}
</script>